<!doctype html>
<html lang="en" class="al-preload">
 <head>
  <script>
    document.documentElement.classList.add('al-preload');
  </script>
  <style>
    /* header visible ‡§∞‡§π‡•á, main page hide ‡§∞‡§π‡•á */
    html.al-preload body[data-page="doubts"] #mainLayout{
      opacity: 0 !important;
      visibility: hidden !important;
    }
  </style>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AlephLearn - Doubts &amp; Solutions</title>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&amp;family=Inter:wght@400;500;600&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="doubt2.css">
  <link rel="stylesheet" href="index.css">
  <link rel="stylesheet" href="header-unified.css">
   <!-- <link rel="stylesheet" href="Hamberger.css"> -->
    <!-- <link rel="stylesheet" href="quizzes.css"> -->
    <link rel="icon" type="image/svg+xml" href="assets/alephlearn-icon.svg">
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body data-page="doubts">

  <header class="nav">
    <div class="nav-inner">
  
      <!-- MOBILE: Burger (LEFT) -->
      <button id="al-burger" class="al-burger" aria-label="Toggle menu">

      </button>
  
      <!-- CENTER: Logo -->
      <div class="brand">
        <a href="index.html">
          <img src="./alephlearn-logo.svg" alt="AlephLearn" class="brand-logo-svg">
        </a>
      </div>
  
      <!-- DESKTOP: Links (mobile pe hide ho jayenge) -->
      <nav class="links">
        <a href="index.html">Dashboard</a>
        <a href="doubts.html">Doubts</a>
        <a href="chat.html">Chat</a>
        <a href="quizzes.html">Quizzes</a>
        <a href="previous-papers.html">Library</a>
        <a href="profile.html">Profile</a>
        <a href="admin.html" id="adminTab" style="display:none;">Admin</a>
        <button class="logout-btn-desktop js-logout">Logout</button>
      </nav>
  
      <!-- RIGHT: Avatar -->
      <div class="navbar-avatar" id="navbarAvatar">?</div>
  
    </div>
  </header>


<nav class="al-drawer" id="al-drawer">
  <div class="al-drawer-head">
    <h3>Menu</h3>
    <button class="al-drawer-close" type="button">‚úï</button>
  </div>
  <div class="al-drawer-links">
    <a href="index.html"> Dashboard</a>
    <a href="doubts.html"> Doubts</a>
    <a href="chat.html"> Chat</a>
    <a href="quizzes.html"> Quizzes</a>
    <a href="previous-papers.html"> Previous Papers</a>
    <!-- <a href="leaderboard.html"> Leaderboard</a> -->
    <a href="profile.html"> Profile</a>
    <a href="admin.html" id="adminTabMobile" style="display:none;"> Admin</a>
    <!-- Mobile logout button -->
    <button class="logout-btn js-logout" type="button">
      <span class="icon"></span>
      <span class="text">Logout</span>
    </button>
  </div>
</nav>

<!-- Backdrop for mobile drawer -->
<div id="al-drawer-backdrop" class="al-drawer-backdrop"></div>

  <nav class="navbar">
   <div class="nav-container">
    <!-- <div class="logo">
    </div> -->
    <div class="nav-links">
      <a href="#" id="askTab" class="nav-link active"><span>‚ùì</span> Ask Doubt</a>
      <a href="#" id="myTab" class="nav-link"><span>üìù</span> My Doubts</a>
    </div>
    <div class="nav-actions">
     <div class="notification-icon"><span>üîî</span> <span id="notifBadge" class="notification-badge">0</span>
     </div>
     <!-- <div class="user-avatar">
      AL
     </div> -->
    </div>
   </div>
  </nav><!-- Main Container -->
  <div class="container" id="mainLayout">
    <div class="left-panel" id="leftPanel">
    <div class="card">
     <h2 class="card-header"><span>‚ùì</span> <span id="askDoubtTitle">Ask a Doubt</span></h2>
     <!-- üîπ STREAM BADGE (Ask Doubt) -->
<div id="doubtStreamBadge" class="doubt-stream-badge hidden">
  <div class="pill">
    <span class="dot"></span>
    <span class="pill-label">Posting as</span>
  </div>
  <div class="stream-text" id="doubtStreamText"></div>
</div>
     <form id="doubtForm">
      <div class="form-group">
        <label class="form-label" for="subject">Subject</label>
        <select id="subject" class="form-select" onchange="showTagSuggestions()">
          <!-- Options will be injected by doubts.js based on stream -->
          <option value="">Select Subject</option>
        </select>
      </div>
      <div class="form-group"><label class="form-label" for="title">Title</label> 
        <input type="text" id="title" class="form-input" placeholder="Brief summary of your doubt">
      </div>
      <div class="form-group"><label class="form-label" for="description">Describe your doubt</label> <textarea id="description" class="form-textarea" placeholder="Explain your doubt in detail..."></textarea>
      </div>
      <div class="code-input-area">
        <div class="code-input-header">
          <span class="code-input-label">
            <span></span>
            <span>Code (Optional)</span>
          </span>
      
          <button type="button" id="attachBtn" class="attach-file-btn">
            <span></span>
            <span>Attach File</span>
          </button>
        </div>
      
        <!-- Code Textarea -->
        <textarea
          id="code"
          class="code-textarea"
          placeholder="// Paste your code here..."
        ></textarea>
      
        <!-- Hidden File Input -->
        <input type="file" id="attachmentInput" style="display: none" />
      
        <!-- Attached File Name Preview -->
        <div
          id="attachmentInfo"
          style="margin-top: 8px; font-size: 14px; color: #555;"
        ></div>
      </div>
        <div class="form-group">
          <label class="form-label">Tags</label>
        
          <div class="tags-area" style="position: relative;">
            <div class="tags-input-container" id="tagsContainer">
              <input
                type="text"
                class="tag-input"
                id="tagsInput"
                placeholder="Add tags..."
                onkeypress="handleTagInput(event)"
                onfocus="showTagSuggestions()"
                oninput="showTagSuggestions()"
              />
            </div>
          
            <div id="tagSuggestions" class="tag-suggestions"></div>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Visibility</label>
          <div class="visibility-toggle">
            <div class="toggle-option" onclick="setVisibility('public')">
              <div class="toggle-radio active" id="publicRadio"></div>
              <span>Public</span>
            </div>
          </div>
        </div>
      <div class="btn-group">
        <button type="button" class="btn btn-primary" onclick="postDoubt()">
          <span></span>
          <span>Post Doubt</span>
        </button>
      
        <button type="button" class="btn btn-secondary" onclick="openPreview()">
          <span></span>
          <span>Preview</span>
        </button>
      </div>
     </form>
    </div><!-- Tips Card -->
    <div class="card">
     <h3 class="card-header"><span>üí°</span> <span>Tips for Better Answers</span></h3>
     <div style="display: flex; flex-direction: column; gap: 1rem;">
      <div style="padding: 0.75rem; background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05)); border-radius: 8px; border-left: 3px solid #667eea;">
       <div style="font-weight: 600; color: #2d3748; margin-bottom: 0.25rem; font-size: 0.9rem;">
        Be Specific
       </div>
       <div style="color: #4a5568; font-size: 0.85rem; line-height: 1.5;">
        Include error messages, expected vs actual output
       </div>
      </div>
      <div style="padding: 0.75rem; background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(5, 150, 105, 0.05)); border-radius: 8px; border-left: 3px solid #10b981;">
       <div style="font-weight: 600; color: #2d3748; margin-bottom: 0.25rem; font-size: 0.9rem;">
        Share Code
       </div>
       <div style="color: #4a5568; font-size: 0.85rem; line-height: 1.5;">
        Paste relevant code snippets to get better help
       </div>
      </div>
      <div style="padding: 0.75rem; background: linear-gradient(135deg, rgba(251, 191, 36, 0.05), rgba(245, 158, 11, 0.05)); border-radius: 8px; border-left: 3px solid #fbbf24;">
       <div style="font-weight: 600; color: #2d3748; margin-bottom: 0.25rem; font-size: 0.9rem;">
        Use Tags
       </div>
       <div style="color: #4a5568; font-size: 0.85rem; line-height: 1.5;">
        Add relevant tags to reach the right experts
       </div>
      </div>
      <div style="padding: 0.75rem; background: linear-gradient(135deg, rgba(239, 68, 68, 0.05), rgba(220, 38, 38, 0.05)); border-radius: 8px; border-left: 3px solid #ef4444;">
       <div style="font-weight: 600; color: #2d3748; margin-bottom: 0.25rem; font-size: 0.9rem;">
        Show Effort
       </div>
       <div style="color: #4a5568; font-size: 0.85rem; line-height: 1.5;">
        Explain what you've tried so far
       </div>
      </div>
     </div>
    </div><!-- Recent Activity Card -->
    <div class="card">
     <h3 class="card-header"><span>‚ö°</span> <span>Your Activity</span></h3>
     <div style="display: flex; flex-direction: column; gap: 0.75rem;">
      <div style="padding: 0.75rem; background: #f7fafc; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(102, 126, 234, 0.05)'" onmouseout="this.style.background='#f7fafc'">
       <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">    <span style="font-weight: 600; color: #2d3748; font-size: 0.9rem;">
        <span id="activity-doubts-count">0</span> Doubts Posted
      </span>
       </div>
       <div style="color: #718096; font-size: 0.8rem;">
        This week
       </div>
      </div>
      <div style="padding: 0.75rem; background: #f7fafc; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(102, 126, 234, 0.05)'" onmouseout="this.style.background='#f7fafc'">
       <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">    <span style="font-weight: 600; color: #2d3748; font-size: 0.9rem;">
        <span id="activity-answers-count">0</span> Answers Given
      </span>
       </div>
       <div style="color: #718096; font-size: 0.8rem;">
        This month
       </div>
      </div>
      <div style="padding: 0.75rem; background: #f7fafc; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(102, 126, 234, 0.05)'" onmouseout="this.style.background='#f7fafc'">
       <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.25rem;">    <span style="font-weight: 600; color: #2d3748; font-size: 0.9rem;">
        <span id="activity-accepted-count">0</span> Solutions Accepted
      </span>
       </div>
       <div style="color: #718096; font-size: 0.8rem;">
        All time
       </div>
      </div>
     </div>
    </div>
   </div><!-- Middle Panel - Doubts Feed -->
   <!-- 11111111111212121212121212132332332432234234324232423 -->
   <div class="middle-panel" id="middlePanel">
    <div class="search-filter-bar">
     <div class="search-box"><span class="search-icon">üîç</span> 
      <input type="text" id="searchInput" class="search-input" placeholder="Search doubts...">
     </div>
     <div class="filter-row">
      <!-- <select id="filterSubject" class="filter-select">
        <option value="ALL">All Subjects</option>
        <option value="Data Structures">Data Structures</option>
        <option value="Algorithms">Algorithms</option>
        <option value="Web Development">Web Development</option>
        <option value="Database">Database</option>
        <option value="Machine Learning">Machine Learning</option>
        <option value="Operating Systems">Operating Systems</option>
      </select> -->
    
      <select id="filterStatus" class="filter-select">
        <option value="ALL">All Status</option>
        <option value="OPEN">Open</option>
        <option value="RESOLVED">Resolved</option>
      </select>
    
      <select id="filterSort" class="filter-select">
        <option value="LATEST">Sort: Latest</option>
        <option value="MOST_LIKED">Most Liked</option>
        <option value="UNANSWERED">Unanswered</option>
        <option value="MOST_VIEWED">Most Viewed</option>
      </select>
    </div>
    </div>
    <h2 class="card-header" style="background: white; padding: 1rem 1.5rem; border-radius: 16px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);"><span>üìã</span> <span id="feedTitle">Recent Doubts</span></h2><!-- Doubt Cards -->

<div id="doubtsFeed"></div>
   </div>

     <!-- Mini Profile Card (for avatar double-click) -->
   <!-- Mini Profile Card (for avatar double-click) -->
   <div id="miniProfileCard" class="mini-profile hidden">
    <div class="mp-inner">
      <div class="mp-avatar">A</div>
      <div class="mp-name">User Name</div>
      <div class="mp-detail">CSE ¬∑ Professional</div>

      <div class="mp-stats">
        <div>
          <strong id="mpSolved">0</strong>
          <span>Solved</span>
        </div>
        <div>
          <strong id="mpLikes">0</strong>
          <span>Likes</span>
        </div>
      </div>

      <div class="mp-actions">
        <!-- LIKE from mini card -->
        <button id="mpLikeBtn" class="mp-like-btn" type="button">
          <span id="mpLikeIcon">üëç</span>
          <span id="mpLikeLabel">Like</span>
        </button>

        <!-- View profile of this user -->
        <button id="mpViewBtn" class="mp-btn" type="button">
          View full profile
        </button>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <!-- Toast Notification -->
  <div class="toast" id="toast">
    <div class="toast-icon">
      ‚úÖ
    </div>
    <div class="toast-message" id="toastMessage">
      Doubt posted successfully!
    </div>
  </div>

  <!-- Preview Modal -->
<div id="previewModal" class="preview-modal" style="display:none;">
  <div class="preview-backdrop" onclick="closePreview()"></div>
  <div class="preview-card">
    <button class="preview-close" onclick="closePreview()">√ó</button>
    <div id="previewContent"></div>
  </div>
</div>

<!-- Edit Doubt Modal -->
<div id="editDoubtOverlay" class="edit-overlay" style="display:none;">
  <div class="edit-modal">
    <h3 class="edit-modal-title">Edit Doubt</h3>

    <label class="edit-label">
      Title
      <input type="text" id="editTitleInput" class="edit-input" />
    </label>

    <label class="edit-label">
      Description
      <textarea id="editDescInput" class="edit-textarea"></textarea>
    </label>

    <label class="edit-label">
      Subject
      <input type="text" id="editSubjectInput" class="edit-input" />
      <!-- agar chaho to yaha simple select bhi bana sakte ho -->
    </label>

    <div class="edit-actions">
      <button type="button" id="editCancelBtn" class="btn btn-secondary">
        Cancel
      </button>
      <button type="button" id="editSaveBtn" class="btn btn-primary">
        Save Changes
      </button>
    </div>
  </div>
</div>

<script>
  (function () {
    const noop = function () {};
    console.log   = noop;
    console.info  = noop;
    console.debug = noop;
    console.warn  = noop;
  })();
</script>
  <script type="module" src="./js/api.js"></script>
  <script type="module" src="./js/academicGuard.js"></script>
  <script type="module" src="./js/auth.js"></script>
  
  <!-- CHANGE THIS LINE -->
  <script src="doubts.js"></script>
  
  <script type="module" src="H1.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
<script src="role-ui.js"></script>
<script src="notifications.js"></script>
<script type="module" src="index.js"></script>
  <script type="module" src="./js/protect.js"></script>

</body>
</html>
